<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>üîß Tr·∫ßn Th√†nh Dz Tool B·∫£o</title>
  <style>
    :root{--bg:#071020;--card:#0b1220;--accent:#ff6b8a;--muted:#9aa4b2}
    body{margin:0;background:linear-gradient(180deg,#051423 0%, #071020 100%);color:#fff;font-family:Inter,Arial,Helvetica,sans-serif}
    .wrap{max-width:940px;margin:18px auto;padding:20px}
    header{display:flex;align-items:center;gap:12px}
    h1{margin:0;font-size:28px}
    .desc{color:var(--muted);margin:8px 0 18px}
    /* small help */
    .help{background:rgba(255,255,255,0.03);padding:12px;border-radius:10px;color:var(--muted);margin-bottom:12px}
    /* mobile friendly */
    @media(max-width:480px){ .wrap{padding:12px} }
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <h1>üîß Tr·∫ßn Th√†nh Dz Tool B·∫£o</h1>
    </header>
    <p class="desc">Nh·∫≠p profile -> L∆∞u -> Xu·∫•t JSON -> D√°n v√†o <code>data.json</code> tr√™n repo -> Commit. Sau ƒë√≥ m·ªü site b·∫±ng Tampermonkey (Kiwi) ƒë·ªÉ script t·ª± nh·∫≠n profile.</p>

    <div class="help">
      <strong>Tip:</strong> B·∫°n c√≥ th·ªÉ t·∫°o nhi·ªÅu profile. ƒê·ªÉ s·ª≠ d·ª•ng tr√™n site: Commit `data.json` r·ªìi reload trang nh√† c√°i.
    </div>
  </div>

  <!-- Panel qu·∫£n l√Ω (floating) -->
  <script>
  (function(){
    // --- localStorage key
    const KEY = 'tran_profiles';
    function $c(t,p){ const e=document.createElement(t); if(p) Object.assign(e,p); return e; }
    function load(){ try{return JSON.parse(localStorage.getItem(KEY)||'[]')}catch(e){return []}}
    function save(v){ localStorage.setItem(KEY, JSON.stringify(v||[])); }

    // build UI
    const panel = $c('div');
    Object.assign(panel.style,{
      position:'fixed',right:'12px',bottom:'12px',zIndex:99999,
      width:'360px',maxWidth:'94vw',background:'var(--card)',padding:'12px',borderRadius:'12px',color:'#fff',
      boxShadow:'0 8px 28px rgba(0,0,0,0.6)',fontSize:'14px'
    });
    panel.innerHTML = `
      <div style="display:flex;align-items:center;justify-content:space-between">
        <strong>‚öôÔ∏è Profiles</strong>
        <small style="opacity:.8">v1.0</small>
      </div>
      <div style="margin-top:8px">
        <input id="p_name" placeholder="T√™n profile" style="width:100%;padding:8px;border-radius:8px;border:none;margin-bottom:6px;background:#071820;color:#fff">
        <div style="display:flex;gap:6px">
          <input id="p_user" placeholder="T√™n t√†i kho·∫£n" style="flex:1;padding:8px;border-radius:8px;border:none;background:#071820;color:#fff">
          <input id="p_pass" placeholder="M·∫≠t kh·∫©u" style="flex:1;padding:8px;border-radius:8px;border:none;background:#071820;color:#fff">
        </div>
        <input id="p_withdraw" placeholder="M·∫≠t kh·∫©u r√∫t ti·ªÅn" style="width:100%;padding:8px;border-radius:8px;border:none;margin-top:6px;background:#071820;color:#fff">
        <input id="p_fullname" placeholder="H·ªç v√† t√™n (IN HOA)" style="width:100%;padding:8px;border-radius:8px;border:none;margin-top:6px;background:#071820;color:#fff">
        <div style="display:flex;gap:6px;margin-top:6px">
          <input id="p_account" placeholder="S·ªë t√†i kho·∫£n" style="flex:1;padding:8px;border-radius:8px;border:none;background:#071820;color:#fff">
          <input id="p_branch" placeholder="Chi nh√°nh / Th√†nh ph·ªë" style="flex:1;padding:8px;border-radius:8px;border:none;background:#071820;color:#fff">
        </div>
        <div style="display:flex;gap:8px;margin-top:8px">
          <button id="btnSave" style="flex:1;padding:8px;border-radius:8px;border:none;background:#ff6b8a;color:#000">L∆∞u profile</button>
          <button id="btnAdd" style="flex:1;padding:8px;border-radius:8px;border:none;background:#06d6a0;color:#000">Th√™m m·ªõi</button>
        </div>
      </div>

      <div id="list" style="margin-top:10px;max-height:180px;overflow:auto"></div>

      <div style="display:flex;gap:8px;margin-top:8px">
        <button id="exportJSON" style="flex:1;padding:8px;border-radius:8px;border:none;background:#3b82f6;color:#fff">Xu·∫•t JSON</button>
        <button id="copyJSON" style="flex:1;padding:8px;border-radius:8px;border:none;background:#f59e0b;color:#000">Sao ch√©p</button>
      </div>

      <div style="display:flex;gap:8px;margin-top:8px">
        <button id="openRegs" style="flex:1;padding:8px;border-radius:8px;border:none;background:#10b981;color:#000">M·ªü 5 trang ƒëƒÉng k√Ω</button>
        <button id="openBanks" style="flex:1;padding:8px;border-radius:8px;border:none;background:#3b82f6;color:#fff">M·ªü trang li√™n k·∫øt ng√¢n h√†ng</button>
      </div>

      <div style="margin-top:8px;display:flex;gap:8px">
        <input id="delay" type="number" value="800" style="flex:1;padding:8px;border-radius:8px;border:none;background:#071820;color:#fff">
        <select id="selProfile" style="flex:1;padding:8px;border-radius:8px;border:none;background:#071820;color:#fff"></select>
      </div>

      <small style="display:block;margin-top:8px;opacity:.8">Sau khi s·ª≠a: d√πng "Xu·∫•t JSON" ho·∫∑c "Sao ch√©p" -> v√†o repo -> m·ªü data.json -> d√°n -> Commit.</small>
    `;

    document.body.appendChild(panel);

    // helpers
    function renderList(){
      const arr = load();
      const list = panel.querySelector('#list');
      const sel = panel.querySelector('#selProfile');
      sel.innerHTML = '';
      list.innerHTML = '';
      if(arr.length===0){ list.innerHTML = '<div style="opacity:.8">Ch∆∞a c√≥ profile</div>'; return; }
      arr.forEach((p, i)=>{
        const row = document.createElement('div'); row.style.display='flex'; row.style.justifyContent='space-between'; row.style.alignItems='center'; row.style.padding='6px 0'; row.style.borderBottom='1px solid rgba(255,255,255,0.03)';
        row.innerHTML = `<div><b>${p.name}</b><div style="opacity:.7;font-size:12px">${p.user || ''} ¬∑ ${p.account || ''}</div></div>`;
        const btns = document.createElement('div');
        const set = document.createElement('button'); set.textContent='Set'; set.style.marginRight='6px';
        const del = document.createElement('button'); del.textContent='X';
        Object.assign(set.style,{padding:'6px',borderRadius:'6px',border:'none',background:'#06b6d4',color:'#000'});
        Object.assign(del.style,{padding:'6px',borderRadius:'6px',border:'none',background:'#ef4444',color:'#fff'});
        set.onclick=()=> loadToForm(i);
        del.onclick=()=> { if(confirm('X√≥a profile n√†y?')) { arr.splice(i,1); save(arr); renderList(); } };
        btns.appendChild(set); btns.appendChild(del); row.appendChild(btns);
        list.appendChild(row);

        const opt = document.createElement('option'); opt.value = p.name; opt.textContent = p.name; sel.appendChild(opt);
      });
    }
    function loadToForm(i){
      const arr = load();
      const p = arr[i];
      if(!p) return;
      panel.querySelector('#p_name').value = p.name || '';
      panel.querySelector('#p_user').value = p.user || '';
      panel.querySelector('#p_pass').value = p.pass || '';
      panel.querySelector('#p_withdraw').value = p.withdraw || '';
      panel.querySelector('#p_fullname').value = p.fullname || '';
      panel.querySelector('#p_account').value = p.account || '';
      panel.querySelector('#p_branch').value = p.branch || '';
    }

    // events
    panel.querySelector('#btnAdd').onclick = ()=>{
      const arr = load();
      const p = {
        name: panel.querySelector('#p_name').value.trim() || ('profile'+(arr.length+1)),
        user: panel.querySelector('#p_user').value.trim(),
        pass: panel.querySelector('#p_pass').value.trim(),
        withdraw: panel.querySelector('#p_withdraw').value.trim(),
        fullname: panel.querySelector('#p_fullname').value.trim(),
        account: panel.querySelector('#p_account').value.trim(),
        branch: panel.querySelector('#p_branch').value.trim()
      };
      arr.push(p); save(arr); renderList(); alert('ƒê√£ th√™m profile');
    };

    panel.querySelector('#btnSave').onclick = ()=>{
      const arr = load();
      const name = panel.querySelector('#p_name').value.trim();
      if(!name) return alert('Nh·∫≠p t√™n profile ƒë·ªÉ l∆∞u');
      const p = {
        name: name,
        user: panel.querySelector('#p_user').value.trim(),
        pass: panel.querySelector('#p_pass').value.trim(),
        withdraw: panel.querySelector('#p_withdraw').value.trim(),
        fullname: panel.querySelector('#p_fullname').value.trim(),
        account: panel.querySelector('#p_account').value.trim(),
        branch: panel.querySelector('#p_branch').value.trim()
      };
      const idx = arr.findIndex(x=>x.name===name);
